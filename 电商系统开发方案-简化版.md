# 电商系统开发方案（简化版）

> **版本说明**：这是简化版电商系统方案，适用于单商家、轻量级部署场景。如需完整功能，请参考 `电商系统开发方案.md`。

## 1. 项目概述

### 1.1 项目目标
开发一套简化的全栈电商系统，支持商品管理、用户管理、订单处理等核心功能，专注于单商家场景，降低硬件资源需求。

### 1.2 系统定位
- **单商家 B2C 电商平台**：面向单一商家和消费者
- **轻量级部署**：对硬件资源要求低，适合小规模运营
- **简化功能**：保留核心电商功能，去除复杂业务逻辑
- **快速上线**：开发周期短，易于维护

### 1.3 简化说明
- ✅ **保留功能**：商品管理、购物车、订单管理、基础管理后台
- ✅ **可选功能**：用户注册/登录（买家可以不登录直接下单）
- ❌ **移除功能**：在线支付（订单改为待付款状态，线下处理）、手机验证、Redis 缓存、对象存储、邮箱验证、第三方登录、优惠券系统、评价系统

## 2. 技术架构

### 2.1 整体架构（简化版）
```
┌─────────────────┐
│   前端应用层    │
│  (React + Vite) │
└────────┬────────┘
         │
┌────────┴────────┐
│   业务服务层    │
│  (Node.js/Python)
└────────┬────────┘
         │
┌────────┴────────┐
│   数据存储层    │
│     (MySQL)     │
└─────────────────┘
```

### 2.2 技术栈选型（轻量版）

#### 前端技术栈
- **框架**：React 18 + TypeScript
- **状态管理**：Zustand（轻量级）
- **UI 组件库**：Ant Design（管理后台）
- **路由**：React Router v6
- **构建工具**：Vite
- **HTTP 客户端**：Axios

#### 后端技术栈
- **运行时**：Python 3.8+
- **框架**：Django 6.0
- **ORM**：Django ORM
- **API 框架**：Django REST Framework
- **验证**：Django 表单验证
- **认证**：JWT（PyJWT）
- **文件上传**：Django 文件上传（本地存储）

#### 数据库
- **关系型数据库**：MySQL 8.0（仅此一个数据库）
- **文件存储**：本地文件系统（uploads 目录）

#### 开发工具
- **版本控制**：Git
- **代码规范**：ESLint + Prettier
- **API 测试**：Postman

## 3. 功能模块设计（简化版）

### 3.1 用户模块（简化，可选）
- **用户注册/登录（可选）**
  - 买家可以不登录直接浏览商品和下单
  - 用户名注册（仅检查唯一性，无需验证）
  - 密码登录
  - 简单的用户名/密码验证
- **用户中心（仅登录用户）**
  - 个人信息管理
  - 收货地址管理（登录用户可保存地址）
  - 密码修改
  - 订单查询（登录用户可查看历史订单）

### 3.2 商品模块
- **商品分类**
  - 二级分类（最多两级）
  - 分类管理
- **商品管理**
  - 商品发布/编辑
  - 商品详情（支持图片）
  - 基础规格管理（可选，简化）
  - 库存管理
- **商品展示**
  - 商品列表
  - 商品详情页
  - 简单搜索（关键词匹配）

### 3.3 购物车模块（支持未登录用户）
- **未登录用户购物车**
  - 使用浏览器 localStorage 存储购物车数据
  - 添加/删除商品
  - 修改商品数量
  - 清空购物车
  - 页面刷新后购物车数据保留
- **登录用户购物车**
  - 使用数据库存储购物车数据
  - 支持多设备同步
  - 添加/删除商品
  - 修改商品数量
  - 清空购物车
- **购物车合并**
  - 用户登录时，将 localStorage 中的购物车合并到数据库

### 3.4 订单模块（简化，支持未登录用户）
- **订单创建（无需登录）**
  - 买家无需登录即可下单
  - 订单信息确认
  - 填写收货信息（姓名、电话、地址）
  - 订单备注
  - 登录用户可选择已保存的收货地址
- **订单管理**
  - **未登录用户**：通过订单号查询订单状态
  - **登录用户**：订单列表查询、订单详情查看、订单状态跟踪
  - 订单取消（仅限待发货状态）
- **订单状态**
  - 待付款（创建后默认状态，需要管理员确认后改为待发货）
  - 待发货
  - 待收货
  - 已完成
  - 已取消

### 3.5 支付模块（移除）
- ❌ 移除所有在线支付功能
- 订单创建后默认为"待付款"状态
- 管理员可手动修改订单状态（线下收款后改为"待发货"）

### 3.6 促销模块（移除）
- ❌ 移除优惠券系统
- ❌ 移除营销活动
- 保留简单的商品价格设置（原价/现价）

### 3.7 评价模块（移除）
- ❌ 移除商品评价功能
- ❌ 移除用户评价

### 3.8 管理后台模块（简化）
- **系统管理**
  - 管理员账户管理（简化权限，单角色）
  - 登录日志（可选）
- **商品管理**
  - 商品上架/下架
  - 商品编辑
  - 分类管理
  - 图片上传（本地存储）
- **订单管理**
  - 订单查询/处理
  - 订单状态修改（待付款 → 待发货 → 待收货 → 已完成）
  - 订单详情查看
- **用户管理**
  - 用户信息查询
  - 用户状态管理（启用/禁用）
- **数据统计（基础）**
  - 订单统计
  - 商品统计
  - 用户统计

## 4. 数据库设计（简化版）

### 4.1 核心数据表（精简）

#### 用户相关表
- `users` - 用户基础信息表（简化，移除邮箱验证、手机验证字段，登录为可选功能）
- `user_addresses` - 用户收货地址表（仅登录用户使用）

#### 商品相关表
- `categories` - 商品分类表（最多二级分类）
- `products` - 商品基础信息表（简化属性）
- `product_images` - 商品图片表（本地路径）

#### 订单相关表
- `orders` - 订单主表（简化支付相关字段，user_id 可为空，支持未登录用户下单）
- `order_items` - 订单商品明细表

#### 购物车表
- `cart_items` - 购物车商品表（仅登录用户，未登录用户使用 localStorage）

#### 系统表
- `admins` - 管理员表（简化权限，单角色）

### 4.2 数据库设计原则（简化）
- 遵循基本范式，适当冗余以提高查询性能
- 合理使用索引
- 移除不必要的关联表
- 简化字段，移除未使用字段

## 5. API 设计规范（简化）

### 5.1 RESTful API 设计
- 使用标准 HTTP 方法（GET、POST、PUT、DELETE）
- 统一响应格式
- 版本控制（/api/v1/）

### 5.2 响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {},
  "timestamp": 1234567890
}
```

### 5.3 认证方式
- **登录用户**：使用 JWT Token 进行身份验证（PyJWT）
- Token 存储在客户端 LocalStorage
- Token 有效期：7 天（可配置）
- **未登录用户**：无需认证，可直接浏览商品和下单
- 订单查询：未登录用户通过订单号和手机号查询订单状态
- Django REST Framework 默认允许所有访问（简化版）

## 6. 项目结构（简化）

### 6.1 前端项目结构
```
frontend/
├── public/                 # 静态资源
├── src/
│   ├── api/               # API 接口封装
│   ├── assets/            # 静态资源
│   ├── components/        # 通用组件
│   ├── pages/             # 页面组件
│   │   ├── Home/          # 首页
│   │   ├── Products/      # 商品列表/详情
│   │   ├── Cart/          # 购物车
│   │   ├── Order/         # 订单
│   │   └── User/          # 用户中心
│   ├── hooks/             # 自定义 Hooks
│   ├── store/             # 状态管理（Zustand）
│   ├── utils/             # 工具函数
│   ├── types/             # TypeScript 类型定义
│   └── App.tsx            # 根组件
├── package.json
└── vite.config.ts
```

### 6.2 后端项目结构（Django）
```
backend/
├── ecommerce/            # Django 项目配置
│   ├── settings.py       # 项目设置
│   ├── urls.py          # URL 路由
│   └── utils.py         # 工具函数
├── users/                # 用户应用
│   ├── models.py        # 数据模型
│   ├── views.py         # 视图
│   ├── serializers.py   # 序列化器
│   ├── urls.py          # URL 路由
│   └── admin.py         # Django Admin
├── products/             # 商品应用
├── orders/               # 订单应用
├── admins/               # 管理员应用
├── manage.py             # Django 管理脚本
├── requirements.txt      # Python 依赖
└── uploads/              # 文件上传目录
```

### 6.3 管理后台结构
```
admin/
├── src/
│   ├── components/        # 组件
│   ├── pages/             # 页面
│   │   ├── Dashboard/     # 仪表盘
│   │   ├── Products/      # 商品管理
│   │   ├── Orders/        # 订单管理
│   │   ├── Users/         # 用户管理
│   │   └── Categories/    # 分类管理
│   ├── layout/            # 布局组件
│   ├── api/               # API
│   └── ...
└── package.json
```

## 7. 开发阶段规划（简化版）

### 第一阶段：项目搭建（3-5天）
- [ ] 项目初始化
- [ ] 技术栈配置（仅 MySQL，无 Redis）
- [ ] 数据库设计和创建（精简表结构）
- [ ] 基础架构搭建
- [ ] 开发环境配置

### 第二阶段：核心功能开发（2-3周）
- [ ] 用户注册/登录模块（简化，无验证）
- [ ] 商品管理模块
- [ ] 购物车模块
- [ ] 订单模块（无支付集成）

### 第三阶段：管理后台（1-2周）
- [ ] 管理员登录
- [ ] 商品管理后台
- [ ] 订单管理后台（手动修改状态）
- [ ] 用户管理后台
- [ ] 基础数据统计

### 第四阶段：功能完善（1周）
- [ ] 图片上传功能（本地存储）
- [ ] 搜索功能优化
- [ ] 界面优化
- [ ] Bug 修复

### 第五阶段：测试和部署（3-5天）
- [ ] 功能测试
- [ ] 性能优化（基础）
- [ ] 安全加固（基础）
- [ ] 部署配置

## 8. 安全考虑（简化）

### 8.1 基础安全
- 密码加密存储（bcrypt）
- SQL 注入防护（ORM）
- XSS 攻击防护（输入过滤）
- CSRF 防护（JWT）
- 文件上传安全（类型、大小限制）

### 8.2 简化安全措施
- ❌ 移除复杂的接口限流（基础防护即可）
- ❌ 移除验证码机制
- ✅ 保留操作日志记录（可选）
- ✅ 保留基础权限控制

## 9. 性能优化（轻量级）

### 9.1 前端优化
- 代码分割和懒加载
- 图片压缩（构建时）
- 静态资源缓存（HTTP 缓存）

### 9.2 后端优化
- 数据库索引优化
- 查询优化
- ❌ 移除 Redis 缓存（简化架构）
- 接口响应优化
- 文件服务优化（静态文件服务）

### 9.3 资源优化
- 数据库连接池配置
- 减少不必要的中间件
- 简化日志输出

## 10. 未登录用户功能实现

### 10.1 购物车实现（未登录用户）
- **存储方式**：使用浏览器 `localStorage` 存储购物车数据
- **数据结构**：
  ```json
  {
    "cart": [
      {
        "productId": 1,
        "quantity": 2,
        "addedAt": "2024-01-01T00:00:00Z"
      }
    ]
  }
  ```
- **功能**：
  - 添加商品到购物车
  - 修改商品数量
  - 删除商品
  - 清空购物车
  - 页面刷新后数据保留
- **登录后合并**：用户登录时，将 localStorage 中的购物车合并到数据库

### 10.2 订单创建（未登录用户）
- **下单流程**：
  1. 浏览商品（无需登录）
  2. 添加到购物车（localStorage）
  3. 进入结算页面
  4. 填写收货信息（姓名、电话、地址）
  5. 提交订单（user_id 为 NULL）
  6. 获得订单号
- **订单查询**：
  - 通过订单号和手机号查询订单状态
  - 无需登录即可查询
- **订单管理**：
  - 未登录用户只能查看订单状态
  - 无法修改订单信息
  - 无法查看历史订单列表

### 10.3 登录用户优势
- 可保存收货地址，下次下单时直接选择
- 可查看历史订单列表
- 购物车数据多设备同步
- 可修改个人信息

## 11. 文件存储方案

### 11.1 本地文件存储
- 使用 `multer` 中间件处理文件上传
- 文件存储在服务器 `uploads/` 目录
- 文件命名：时间戳 + 随机字符串
- 支持的文件类型：jpg, jpeg, png, gif
- 文件大小限制：5MB

### 11.2 文件服务
- 通过 Django 的 MEDIA_URL 配置提供访问
- 路径：`/uploads/:filename`
- 开发环境自动提供静态文件服务

## 12. 部署方案（轻量级）

### 12.1 服务器要求（最低配置）
- **CPU**：1 核
- **内存**：1GB（推荐 2GB）
- **存储**：20GB SSD
- **系统**：Linux（Ubuntu 20.04+ / CentOS 7+）

### 12.2 部署方式
- **方式一**：传统部署（Gunicorn + Nginx）
  - Django 应用使用 Gunicorn 运行
  - Nginx 作为反向代理和静态文件服务
  - MySQL 数据库
- **方式二**：Docker 部署（可选）
  - Docker Compose 编排
  - 包含：Django 应用 + MySQL

### 12.3 监控（简化）
- 基础日志记录（Django logging）
- 系统进程监控
- ❌ 移除复杂的 APM 监控

## 13. 系统限制说明

### 13.1 功能限制
- 单商家模式，不支持多商家
- 无在线支付，需线下处理
- 无手机验证功能
- 无缓存机制，查询性能依赖数据库
- 本地文件存储，需定期备份
- 买家无需登录即可下单（登录为可选功能）

### 13.2 性能限制
- 并发用户数：建议 < 100 同时在线
- 商品数量：建议 < 1000 个商品
- 订单处理：建议 < 100 订单/天

### 13.3 扩展建议
当业务增长时，可考虑：
- 引入 Redis 缓存
- 使用对象存储服务（OSS/COS）
- 接入在线支付
- 升级服务器配置

## 14. 成功标准

- 功能完整度：核心功能 100% 实现
- 性能指标：页面加载时间 < 2s（简化版优化），API 响应时间 < 1s
- 可用性：系统可用率 > 95%
- 安全性：通过基础安全测试
- 用户体验：界面简洁，操作流畅
- 资源占用：内存占用 < 512MB（不含数据库）

## 15. 与原方案对比

| 功能模块 | 完整版 | 简化版 |
|---------|--------|--------|
| 支付方式 | 在线支付（微信/支付宝） | ❌ 移除，线下处理 |
| 用户验证 | 邮箱/手机验证 | ✅ 仅用户名唯一性检查 |
| 登录方式 | 密码/短信/第三方登录 | ✅ 仅密码登录（可选） |
| 买家登录 | 必须登录 | ✅ **无需登录即可下单** |
| 购物车 | 数据库存储 | ✅ 登录用户用数据库，未登录用 localStorage |
| 缓存系统 | Redis | ❌ 移除 |
| 文件存储 | 对象存储（OSS/COS） | ✅ 本地文件系统 |
| 优惠券 | 支持 | ❌ 移除 |
| 商品评价 | 支持 | ❌ 移除 |
| 商家模式 | 多商家 | ✅ 单商家 |
| 权限管理 | 多角色权限 | ✅ 单角色 |
| 数据统计 | 详细统计 | ✅ 基础统计 |

---

**文档版本**：v2.0（简化版）  
**创建日期**：2026.1.9
**适用场景**：小型电商、个人商家、轻量级部署
