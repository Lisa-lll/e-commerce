# 项目启动说明

## 环境要求

- Node.js 18.0.0+
- MySQL 8.0+
- npm 9.0.0+（或 yarn/pnpm）

## 快速启动步骤

### 1. 安装依赖

#### 后端（Django）
```bash
cd backend

# 创建虚拟环境（如果还没有）
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/Mac:
# source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

#### 前端
```bash
cd frontend
npm install
```

#### 管理后台
```bash
cd admin
npm install
```

### 2. 配置数据库

#### 创建数据库
```sql
CREATE DATABASE ecommerce_simple CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### 配置后端环境变量
```bash
cd backend
cp .env.example .env
# 编辑 .env 文件，修改数据库连接信息
```

### 3. 初始化数据库

```bash
cd backend

# 确保虚拟环境已激活
# Windows: venv\Scripts\activate
# Linux/Mac: source venv/bin/activate

# 创建数据库迁移文件
python manage.py makemigrations

# 执行数据库迁移
python manage.py migrate

# 可选：创建超级管理员（Django admin）
python manage.py createsuperuser
```

### 4. 启动项目

#### 启动后端（终端 1）
```bash
cd backend

# 确保虚拟环境已激活
# Windows: venv\Scripts\activate
# Linux/Mac: source venv/bin/activate

python manage.py runserver
```
后端服务运行在：http://localhost:8000

#### 启动前端（终端 2）
```bash
cd frontend
npm run dev
```
前端运行在：http://localhost:5173

#### 启动管理后台（终端 3）
```bash
cd admin
npm run dev
```
管理后台运行在：http://localhost:5174

## 验证安装

### 后端健康检查
访问：http://localhost:8000/health

应该返回：
```json
{
  "code": 200,
  "message": "服务运行正常",
  "timestamp": null
}
```

### API 版本信息
访问：http://localhost:8000/api/v1

应该返回：
```json
{
  "code": 200,
  "message": "API 服务正常",
  "version": "1.0.0",
  "timestamp": null
}
```

## 项目结构

```
e-commerce/
├── backend/          # 后端项目（Django + Python）
│   ├── ecommerce/    # Django 项目配置
│   ├── users/        # 用户应用
│   ├── products/     # 商品应用
│   ├── orders/       # 订单应用
│   ├── admins/       # 管理员应用
│   ├── manage.py     # Django 管理脚本
│   ├── requirements.txt  # Python 依赖
│   └── uploads/      # 文件上传目录
├── frontend/         # 前端项目（React + Vite）
│   └── src/          # 源代码
├── admin/            # 管理后台（React + Vite）
│   └── src/          # 源代码
└── README.md         # 项目说明
```

## 下一步

1. 查看 [快速启动指南-简化版](./快速启动指南-简化版.md) 了解详细配置
2. 查看 [数据库设计-简化版](./数据库设计-简化版.md) 了解数据库结构
3. 开始开发功能模块

## 常见问题

### 数据库连接失败
- 检查 MySQL 服务是否启动
- 检查 `.env` 中的数据库配置是否正确
- 检查数据库用户权限

### 端口被占用
- 修改 `.env` 中的端口配置
- 或使用 `lsof -i :3000` 查看占用端口的进程（Linux/Mac）
- 或使用 `netstat -ano | findstr :3000` 查看（Windows）

### Prisma 迁移失败
- 检查数据库连接
- 检查 `schema.prisma` 语法
- 可以手动重置数据库：`npx prisma migrate reset`（开发环境）

## 开发提示

- 后端使用 Django + Python
- 前端使用 Vite，支持热模块替换（HMR）
- 使用 Django Admin 管理数据：访问 http://localhost:8000/admin
- 使用 Django Shell：`python manage.py shell`
- 支持未登录用户下单，订单表 `user` 可为空
