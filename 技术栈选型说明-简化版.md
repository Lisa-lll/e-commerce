# 技术栈选型说明（简化版）

> **版本说明**：这是简化版技术栈选型说明，适用于单商家、轻量级部署场景。移除了 Redis、对象存储、支付 SDK 等复杂组件。

## 1. 前端技术选型（轻量版）

### 1.1 React 18 + TypeScript

**选择理由：**
- React 生态系统成熟，社区活跃
- TypeScript 提供类型安全，减少运行时错误
- 组件化开发，代码可复用性高
- Hooks API 使代码更简洁

**保持不变**：与原版相同

### 1.2 状态管理：Zustand（推荐）

**选择理由：**
- 轻量级，体积小（< 1KB）
- API 简单，学习曲线平缓
- 无需 Provider 包裹
- 性能优秀，适合中小型项目

**移除选项：** Redux Toolkit（功能过于强大，不适合简化版）

### 1.3 UI 组件库

**管理后台：Ant Design**
- 组件丰富，开箱即用
- 设计规范统一
- 适合管理后台快速开发

**前台商城：自定义 UI 或 Tailwind CSS**
- 减少依赖，降低打包体积
- 可定制性强
- 性能更好

**移除选项：** Material-UI（体积较大）

### 1.4 构建工具：Vite

**优势：**
- 极快的开发服务器启动
- 热模块替换（HMR）快速
- 生产构建优化好
- 配置简单

**保持不变**：与原版相同

## 2. 后端技术选型（轻量版）

### 2.1 Python 运行时

**选择理由：**
- Python 语法简洁，开发效率高
- 丰富的第三方库生态
- Django 框架成熟稳定
- 适合快速开发

### 2.2 后端框架：Django（推荐）

**选择理由：**
- 功能完善，开箱即用
- ORM 内置，数据库操作简单
- Admin 管理界面自动生成
- 安全性好（内置 CSRF、XSS 防护）
- 文档完善，社区活跃
- 适合中小型项目快速开发

### 2.3 ORM：Django ORM

**选择理由：**
- Django 内置 ORM，无需额外安装
- 迁移工具完善（makemigrations、migrate）
- 查询 API 直观易用
- 支持复杂查询和关联
- 自动生成数据库表结构

### 2.4 API 框架：Django REST Framework

**选择理由：**
- Django 官方推荐的 REST API 框架
- 序列化器自动处理数据转换
- 视图集（ViewSet）简化 CRUD 操作
- 内置权限和认证系统
- 自动生成 API 文档（可选）

**说明**：简化版使用 DRF 提供 RESTful API

## 3. 数据库选型（简化版）

### 3.1 MySQL 8.0

**选择理由：**
- 成熟稳定，广泛应用
- 事务支持完善
- 生态工具丰富
- 社区活跃
- 资源占用适中

**保持不变**：与原版相同

### 3.2 Redis（移除）

**移除理由：**
- 简化版不需要缓存
- 减少资源占用
- 降低系统复杂度
- 减轻运维负担

**替代方案：**
- 使用 MySQL 直接查询（数据量小的情况下性能可接受）
- 前端缓存（LocalStorage/SessionStorage）
- HTTP 缓存头（Cache-Control）

### 3.3 对象存储（移除）

**移除理由：**
- 使用本地文件系统存储
- 减少第三方服务依赖
- 降低成本和复杂度

**替代方案：**
- 本地文件存储（`uploads/` 目录）
- Express 静态文件服务
- 定期备份文件

## 4. 文件存储方案（简化版）

### 4.1 本地文件存储

**技术栈：**
- Django 文件上传处理
- Django 静态文件服务
- Pillow（图片处理）

**实现方案：**
```python
# Django settings.py
MEDIA_URL = '/uploads/'
MEDIA_ROOT = BASE_DIR / 'uploads'

# 文件上传处理
from django.core.files.storage import FileSystemStorage
from django.core.files.uploadedfile import UploadedFile

# 在视图中处理文件上传
# 使用 Django REST Framework 的 FileField 或 ImageField
```

**存储结构：**
```
uploads/
├── avatars/          # 用户头像
├── products/         # 商品图片
└── categories/       # 分类图片
```

### 4.2 文件管理

**文件命名：**
- 时间戳 + 随机字符串
- 格式：`{timestamp}_{random}.{ext}`

**文件限制：**
- 支持类型：jpg, jpeg, png, gif
- 文件大小：最大 5MB
- 图片尺寸：建议前端压缩后再上传

## 5. 认证授权（简化版）

### 5.1 JWT (JSON Web Token)

**选择理由：**
- 无状态认证
- 跨域支持
- 轻量级
- 适合 RESTful API

**保持不变**：与原版相同

### 5.2 实现方案

**技术栈：**
- `PyJWT` - JWT 生成和验证
- Django `make_password` / `check_password` - 密码加密

**简化说明：**
- ❌ 移除 Token 刷新机制（简化版使用固定过期时间）
- ❌ 移除复杂的权限系统（管理员单角色）
- ✅ 保留基础 JWT 认证
- ✅ 使用 Django REST Framework 的认证系统

## 6. 开发工具（简化版）

### 6.1 代码规范

**ESLint + Prettier**
- 代码风格统一
- 自动格式化
- 错误检查

**保持不变**：与原版相同

### 6.2 Git 工作流

**简化分支策略：**
- `main` - 主分支（生产环境）
- `develop` - 开发分支（可选）
- `feature/*` - 功能分支

**移除：** `hotfix/*` 分支（简化版可直接在主分支修复）

### 6.3 测试工具（可选）

**简化测试：**
- 手动测试为主
- 可选：Jest（单元测试）

**移除：** E2E 测试工具（Cypress/Playwright），简化版不需要

## 7. 部署和运维（简化版）

### 7.1 容器化（可选）

**Docker + Docker Compose**
- 仅包含 MySQL 数据库（可选）
- Node.js 应用可直接部署
- 减少 Docker 复杂度

**简化方案：** 不使用 Docker，直接部署在服务器上

### 7.2 进程管理：Gunicorn（生产环境）

**选择理由：**
- Python WSGI HTTP 服务器
- 多进程支持
- 性能优秀
- 适合生产环境

**开发环境：**
- 使用 Django 内置开发服务器：`python manage.py runserver`

**生产环境配置：**
```bash
gunicorn ecommerce.wsgi:application --bind 0.0.0.0:8000 --workers 2
```

**或使用 systemd 服务：**
- 创建 systemd 服务文件
- 自动启动和重启

### 7.3 反向代理：Nginx（可选）

**简化方案：**
- 小规模部署可以不使用 Nginx
- Express 直接监听端口（如 3000）
- 如需 HTTPS，可使用 Let's Encrypt 的 certbot

**如果需要 Nginx：**
- 静态文件服务
- SSL 终止（HTTPS）
- 反向代理

## 8. 第三方服务（移除）

### 8.1 支付服务（移除）

**移除理由：**
- 简化版不支持在线支付
- 订单状态由管理员手动修改

### 8.2 短信服务（移除）

**移除理由：**
- 不需要手机验证
- 不需要短信通知

### 8.3 CDN（移除）

**移除理由：**
- 使用本地文件存储
- 小规模访问不需要 CDN
- 如需加速，可后续添加

## 9. 监控和日志（简化版）

### 9.1 日志管理

**方案：**
- Python `logging` 模块
- Django logging 配置
- 日志写入文件
- 定期清理旧日志

**简化说明：**
- ❌ 移除 ELK Stack（复杂）
- ❌ 移除 Grafana（复杂）
- ✅ 保留文件日志
- ✅ 使用 Django 内置日志系统

### 9.2 监控（简化）

**方案：**
- systemd 服务监控（Linux）
- 基础日志监控
- 手动检查服务器资源
- Django Debug Toolbar（开发环境，可选）

**移除：**
- APM 工具（Sentry、New Relic）
- 复杂的监控系统

## 10. 安全工具（简化版）

### 10.1 基础安全中间件

**必需：**
- Django 内置安全中间件（CSRF、XSS 防护）
- Django 表单验证
- Django `make_password` / `check_password` - 密码加密

**可选：**
- Django REST Framework 限流（Throttling）

**移除：**
- 复杂的限流策略
- 验证码系统（不需要）

### 10.2 安全措施

**基础防护：**
- SQL 注入防护（ORM）
- XSS 攻击防护（输入过滤）
- CSRF 防护（JWT）
- 文件上传安全（类型、大小限制）

## 11. 性能优化（轻量版）

### 11.1 前端优化

**必需：**
- 代码分割和懒加载
- 图片压缩（构建时）
- 静态资源缓存

**可选：**
- `react-query` / `swr` - 数据获取和缓存（前端缓存）

**移除：**
- CDN 加速（不需要）
- 复杂的缓存策略

### 11.2 后端优化

**必需：**
- 数据库索引优化
- 查询优化（避免 N+1 查询）
- 接口响应优化
- 文件服务优化

**可选：**
- `compression` - Gzip 压缩

**移除：**
- Redis 缓存
- 集群模式（单进程即可）
- 复杂的负载均衡

## 12. 技术栈总结（简化版）

### 12.1 推荐技术栈（轻量级）

**前端：**
- React 18 + TypeScript
- Vite
- Zustand（状态管理）
- React Router v6
- Axios
- Ant Design（管理后台）
- Tailwind CSS（前台商城，可选）

**后端：**
- Python 3.8+
- Django 6.0
- Django REST Framework
- Django ORM
- MySQL 8.0（仅此一个数据库）
- PyJWT（认证）
- Pillow（图片处理）
- Python logging（日志）

**工具：**
- ESLint + Prettier（前端）
- Git
- Gunicorn（进程管理，生产环境）
- Nginx（可选）

**移除：**
- ❌ Redis
- ❌ 对象存储（OSS/COS/S3）
- ❌ Docker（可选）
- ❌ 支付 SDK
- ❌ 短信服务
- ❌ 复杂的监控系统
- ❌ CDN

### 12.2 资源占用估算

**开发环境：**
- Django 应用：约 100-200MB 内存
- MySQL：约 200-300MB 内存
- 总计：约 300-500MB 内存

**生产环境（最低配置）：**
- 服务器：1 核 1GB 内存
- 存储：20GB SSD
- 数据库：MySQL（单实例）
- 应用：Django（Gunicorn，2 workers）

### 12.3 与原版对比

| 技术组件 | 完整版 | 简化版 |
|---------|--------|--------|
| 后端运行时 | Node.js | ✅ Python |
| 后端框架 | Express / NestJS | ✅ Django |
| ORM | Prisma | ✅ Django ORM |
| API 框架 | Express | ✅ Django REST Framework |
| 数据库 | MySQL + Redis | ✅ 仅 MySQL |
| 文件存储 | 对象存储（OSS/COS） | ✅ 本地文件系统 |
| 缓存 | Redis | ❌ 移除 |
| 容器化 | Docker + Compose | ❌ 可选 |
| 反向代理 | Nginx | ⚠️ 可选 |
| 进程管理 | PM2 | ✅ Gunicorn/systemd |
| 监控 | APM + ELK | ❌ 基础日志 |
| 支付 | 微信/支付宝 SDK | ❌ 移除 |
| 短信 | 阿里云/腾讯云 | ❌ 移除 |
| 认证 | JWT + Refresh Token | ✅ JWT（简化） |
| 权限 | RBAC（多角色） | ✅ 单角色 |

## 13. 学习资源

### 13.1 核心技术文档

- React: https://react.dev
- TypeScript: https://www.typescriptlang.org
- Python: https://www.python.org
- Django: https://docs.djangoproject.com
- Django REST Framework: https://www.django-rest-framework.org
- Ant Design: https://ant.design

### 13.2 推荐学习路径（简化版）

1. Python 基础
2. Django 基础 → Models → Views → URLs
3. Django REST Framework
4. React 基础 → Hooks
5. 数据库设计和 SQL
6. Django ORM 使用
7. 前后端联调
8. 基础部署（Gunicorn + Nginx）

## 14. 迁移建议

### 14.1 从完整版迁移到简化版

如果后续需要升级到完整版：

1. **添加 Redis**：引入 Redis 缓存，提升性能
2. **使用对象存储**：将本地文件迁移到 OSS/COS
3. **接入支付**：集成微信/支付宝支付 SDK
4. **添加缓存**：实现 Redis 缓存策略
5. **完善权限**：引入 RBAC 权限系统

### 14.2 从简化版扩展到完整版

升级路径：
- 先添加 Redis 缓存（性能提升）
- 再使用对象存储（文件管理）
- 最后接入支付系统（业务完整）

### 14.3 从 Node.js 迁移到 Django

已完成迁移：
- ✅ 后端框架：Express → Django
- ✅ ORM：Prisma → Django ORM
- ✅ 运行时：Node.js → Python
- ✅ 进程管理：PM2 → Gunicorn
- ✅ 端口：3000 → 8000

---

**文档版本**：v2.0（简化版）  
**创建日期**：2026.1.9  
**适用场景**：小型电商、个人商家、轻量级部署
